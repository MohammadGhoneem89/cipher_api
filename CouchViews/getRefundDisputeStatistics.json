{"_id":"_design/getRefundDisputeStatistics","_rev":"5-72eee3e837927f06da722d8f8e18ffc6","views":{"getRefundDisputeStatistics":{"reduce":"function (keys, values, rereduce) {\r\n  \r\n  var json = {\r\n        disputeCnt : 0,\r\n        refundCnt : 0,\r\n        disputeAmt : 0.00,\r\n        refundAmt  : 0.00\r\n  }\r\n \r\n  for(var i=0;i<values.length;i++){\r\n       json.disputeCnt += values[i].disputeCnt\r\n       json.disputeAmt += values[i].disputeAmt\r\n       json.refundCnt += values[i].refundCnt\r\n       json.refundAmt += values[i].refundAmt\r\n  }\r\n  return json\r\n}","map":"function (doc) {\r\n   \r\n   var json = {\r\n        recordType :\"\",\r\n        disputeCnt : 0,\r\n        refundCnt : 0,\r\n        disputeAmt : 0.00,\r\n        refundAmt  : 0.00\r\n   }\r\n  \r\n   if(doc.data.DocumentName === \"RefundView\"){\r\n      var now = new Date(doc.data.REFUNDINITTS * 1000);\r\n      var startOfDay = new Date(now.getFullYear(), now.getMonth(), now.getDate());\r\n      var timestamp = startOfDay / 1000;\r\n      // please don't change the keys indexes\r\n      var keys = [\r\n        timestamp, \r\n        doc.data.SPCode, \r\n        doc.data.ServiceCode, \r\n        doc.data.PaymentMethod,\r\n        doc.data.paymentChannel,\r\n        doc.data.Status,\r\n\t\t    doc.data.EPayStatusAuthRecv\r\n       ];\r\n       json.recordType = \"R\"\r\n       json.refundCnt = 1\r\n       json.refundAmt = doc.data.TotalBillAmount;\r\n       emit(keys,json);\r\n  }\r\n  \r\n  if(doc.data.DocumentName === \"DisputeView\"){\r\n      var now = new Date(doc.data.DISPUTEINITTS * 1000);\r\n      var startOfDay = new Date(now.getFullYear(), now.getMonth(), now.getDate());\r\n      var timestamp = startOfDay / 1000;\r\n      // please don't change the keys indexes\r\n      var keys = [\r\n        timestamp, \r\n        doc.data.SPCode, \r\n        doc.data.ServiceCode, \r\n        doc.data.PaymentMethod,\r\n        doc.data.paymentChannel,\r\n        doc.data.Status,\r\n\t\t    doc.data.EPayStatusAuthRecv\r\n       ];\r\n       json.recordType = \"D\"\r\n       json.disputeCnt = 1\r\n       json.disputeAmt = doc.data.TotalBillAmount;\r\n       emit(keys,json);\r\n  }\r\n}\r\n"}},"language":"javascript"}