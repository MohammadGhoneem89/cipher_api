{"_id":"_design/acquirerCommissionReport","_rev":"4-cf8fecf0c417bb8bff56f0e63d4b1ed0","views":{"acquirerCommissionReport":{"map":"function (doc) {\r\n\r\n    var json = {\r\n        CardType : \"\",\r\n        PaymentGateway : \"\",\r\n        CommissionStartDate : 0,\r\n        CommissionEndDate : 0,\r\n        CommissionAmount : 0,\r\n        Status : \"\",\r\n        InitiatedBy : \"\",\r\n        ApprovedBy : \"\",\r\n        TransferDate : 0,\r\n        TransferStatus  : \"\",\r\n        Acquirer: \"\",\r\n        RefundCommissionAmount : 0\r\n    }\r\n    if (doc.DocumentName == \"ConsolidatedView\"\r\n        && doc.CommissionBatchID !=\"\"){\r\n          if(doc.ISRFND == true){\r\n            json.RefundCommissionAmount = doc.AcquirerCommissionAmt\r\n          }\r\n          else{\r\n            json.CommissionAmount = doc.AcquirerCommissionAmt\r\n          }\r\n        var timestamp = doc.CommissionBatchID.replace(doc.AcquirerId,\"\")\r\n        var ltimestamp = parseInt(timestamp,10);\r\n        json.CardType = doc.CardType\r\n        json.PaymentGateway = doc.PaymentGateway\r\n        emit([ltimestamp,doc.AcquirerId,doc.CommissionBatchID], json);\r\n    }\r\n    if (doc.DocumentName == \"Commission\" ){\r\n        json.CommissionStartDate = doc.StartDate\r\n        json.CommissionEndDate = doc.EndDate\r\n        json.Status =  doc.Status\r\n        json.InitiatedBy = doc.INITBy\r\n        json.ApprovedBy = doc.APRVBy\r\n        json.TransferDate =doc.DEBTTimestamp\r\n        json.TransferStatus = doc.ISDEBT\r\n        json.AcquirerId = doc.SPCode\r\n\r\n        emit([doc.INITTimestamp,doc.SPCode,doc.CommissionBatchNo,json], json);\r\n    }\r\n\r\n\r\n}","reduce":"\r\nfunction (keys, values, rereduce) {\r\n  var reduceObj = {count :0,amount :0.00}\r\n  for(var j=0;j<values.length;j++){\r\n    reduceObj.count += rereduce ? values[j].count : 1;\r\n    reduceObj.amount +=values[j].amount\r\n  }\r\n   return reduceObj;\r\n}\r\n"}},"language":"javascript"}